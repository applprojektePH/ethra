.row
    .col-md-12
        .row
            .col-md-6
                button.excelexport.btn.btn-primary.btn-sm
                    | Excel Export
                    i.fas.fa-file-excel
            .col-md-6
                select.form-select.form-control.custom-control-select.filter.floatright(name='filter')
                    option(selected='' disabled='' value='') Anträge filtern
                    option(value='') Alle
                    option(value="Antrag in Bearbeitung") in Bearbeitung
                    option(value="OV") OV
                    option(value="VW") VW
                    option(value="Antrag bei Gremium") bei Gremium
                    option(value="Antrag genehmigt") genehmigt
                    option(value="abgelehnt") abgelehnt
                br
        table.table.table-striped.table-works#Softwaretable(data-toggle="table" data-pagination="true"
            data-search="true" data-sort="true")
            thead
                tr(role='row')
                    th(role='columnheader') Antragsnr.
                    th.minwidth(role='columnheader') Thema/Titel des Vorhabens
                    th(role='columnheader') Beantragt am
                    th(role='columnheader') Ersteller*innen
                    th(role='columnheader') Institut
                    th(role='columnheader') Stichtag
                    th(role='columnheader') Status
            tbody
            if (typeof (softwareList) !== 'undefined')
                for order in softwareList
                        tr
                            td
                                if ((order.proc) !== 0)
                                    if (order.proc == 1)
                                        a#link(href="/ethra/details?tsid=" + order.applicationid class="link-id")= order.applicationid + " (OV)"
                                    if (order.proc == 2)
                                        a#link(href="/ethra/details?tsid=" + order.applicationid class="link-id")= order.applicationid + " (VW)"
                                else
                                    a#link(href="/ethra/details?tsid=" + order.applicationid class="link-id")= order.applicationid
                            td= order.topic
                            td= order.dateapp
                            td
                                span= order.firstname
                                span &nbsp;
                                span= order.lastname
                            if((order.institute) && (order.institute !== 'undefined'))
                                td= order.institute
                            else
                                td=" "
                            if((order.deadline) && (order.deadline !== 'undefined'))
                                td.deadline= order.deadline
                            else
                                td=" "
                            td= order.status

script(type='text/javascript' src="./static/js/libs/jquery.js")
//script(type='text/javascript' src="./static/js/libs/bootstrap.bundle.min.js" crossorigin="anonymous")

script(type='text/javascript' src="./static/js/custom.js")
//script(type='text/javascript' src="./static/js/libs/bootstrap-table.js")
script(type="text/javascript" src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js")
script(type='text/javascript' src="./static/js/libs/bootstrap-extension.js")
<script lang="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.2/xlsx.full.min.js"></script>
<script lang="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
script(type='text/javascript').
    var wb = XLSX.utils.table_to_book(document.getElementById('Softwaretable'), {sheet:"Ethra Anträge", blankRows: false, raw: true});
    var wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
    function s2ab(s) {
        var buf = new ArrayBuffer(s.length);
        var view = new Uint8Array(buf);
        for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
        return buf;
    }
    $(".excelexport").click(function () {
        saveAs(new Blob([s2ab(wbout)], { type: "application/octet-stream" }), 'EthraAntraege.xlsx');
    })

